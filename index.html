<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flip on Arbitrum - Farcaster Mini App</title>
    <link rel="stylesheet" href="style.css">
    <meta property="fc:frame" content="vNext">
    <meta property="fc:frame:image" content="https://my-flip.vercel.app//image.png">
    <meta property="fc:frame:button:1" content="Play Flip Game">
    <meta property="fc:frame:post_url" content="https://my-flip.vercel.app/">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="glass-card">
            <h1>🪙 Flip on Arbitrum</h1>
            <p>Heads = Instant Reward | Tails = No Reward</p>
            <div class="wallet-status" id="walletStatus">
                <button id="connectWallet" class="connect-btn">Connect Wallet</button>
            </div>
        </header>

        <!-- Main Game Area -->
        <main class="game-section">
            <div class="coin-container glass-card">
                <div class="coin" id="coin">
                    <div class="coin-face heads">H</div>
                    <div class="coin-face tails">T</div>
                </div>
                <button id="flipButton" class="flip-btn">Flip Coin</button>
                <div class="game-stats">
                    <div class="stat">
                        <span class="stat-label">Total Flips</span>
                        <span class="stat-value" id="totalFlips">0</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Rewards Won</span>
                        <span class="stat-value" id="rewardsWon">0</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Current Streak</span>
                        <span class="stat-value" id="currentStreak">0</span>
                    </div>
                </div>
            </div>

            <!-- Leaderboard -->
            <div class="leaderboard glass-card">
                <h2>🏆 Top 10 Flippers</h2>
                <div class="leaderboard-list" id="leaderboard">
                    <!-- Leaderboard entries will be populated by JS -->
                </div>
            </div>
        </main>

        <!-- Toast Container -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <script type="module" src="app.js
        border: '1px solid rgba(255,255,255,0.3)', 
                                        color: 'white', 
                                        padding: '5px 10px', 
                                        borderRadius: '15px', 
                                        marginLeft: '10px', 
                                        cursor: 'pointer' 
                                    }}
                                >
                                    Disconnect
                                </button>
                            </div>

                            <div className="card">
                                <div 
                                    className={`coin ${isFlipping ? 'spinning' : ''}`}
                                    onClick={flipCoin}
                                >
                                    {isFlipping ? '🌪️' : (result === 'heads' ? '👑' : result === 'tails' ? '❌' : '🪙')}
                                </div>
                                
                                <div className="stats">
                                    <div className="stat">
                                        <div className="stat-value">{stats.totalFlips}</div>
                                        <div>Total Flips</div>
                                    </div>
                                    <div className="stat">
                                        <div className="stat-value">{stats.wins}</div>
                                        <div>Wins</div>
                                    </div>
                                    <div className="stat">
                                        <div className="stat-value">
                                            {stats.totalFlips > 0 ? Math.round((stats.wins / stats.totalFlips) * 100) : 0}%
                                        </div>
                                        <div>Win Rate</div>
                                    </div>
                                </div>

                                <button 
                                    className="btn" 
                                    onClick={flipCoin}
                                    disabled={isFlipping}
                                >
                                    {isFlipping ? 'Flipping...' : 'Flip Coin'}
                                </button>

                                {result && (
                                    <div style={{ fontSize: '1.1rem', fontWeight: '600', marginTop: '15px' }}>
                                        {result === 'heads' ? '👑 HEADS - You Win!' : '❌ TAILS - Try Again!'}
                                    </div>
                                )}
                            </div>
                        </>
                    )}

                    <div className="leaderboard">
                        <h2>🏆 Top 10 Flippers</h2>
                        {leaderboard.map((item, i) => (
                            <div key={item.address} className="leader-item">
                                <span>#{i + 1} {item.address}</span>
                                <span style={{ color: '#ffd700', fontWeight: 'bold' }}>{item.flips}</span>
                            </div>
                        ))}
                    </div>
                </>
            );
        }

        // Initialize app
        const root = createRoot(document.getElementById('app'));
        root.render(React.createElement(App));

        // Farcaster frame support
        window.addEventListener('message', (event) => {
            if (event.data.type === 'farcaster-frame-ready') {
                console.log('Farcaster frame ready');
            }
        });

        if (window.parent !== window) {
            window.parent.postMessage({ type: 'frame-ready' }, '*');
        }
    </script>
</body>
</html>
